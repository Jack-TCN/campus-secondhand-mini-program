<!-- pages/index/index.wxml -->
<view class="container">
  <!-- æœç´¢å¤´ -->
  <view class="header">
    <van-search
      value="{{ searchValue }}"
      placeholder="ğŸ” æœç´¢ç¥æ¥é—²ç½®å•†å“"
      background="transparent"
      shape="round"
      bind:search="onSearch"
    />
  </view>

  <!-- åˆ†ç±»å¯¼èˆª -->
  <scroll-view class="category-scroll" scroll-x>
    <view class="category-list">
      <view 
        class="category-item {{currentCategory === 'all' ? 'active' : ''}}"
        bind:tap="onCategoryTap"
        data-category="all"
      >
        <text class="category-icon">ğŸ </text>
        <text class="category-name">å…¨éƒ¨</text>
      </view>
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-item {{currentCategory === item.id ? 'active' : ''}}"
        bind:tap="onCategoryTap"
        data-category="{{item.id}}"
      >
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- å•†å“åˆ—è¡¨ -->
  <scroll-view 
    scroll-y 
    class="products-scroll"
    bindscrolltolower="onReachBottom"
    enable-back-to-top
  >
    <view class="products-grid">
      <view 
        wx:for="{{products}}" 
        wx:key="_id"
        class="product-card" 
        bind:tap="toDetail" 
        data-id="{{item._id}}"
      >
        <image class="product-image" src="{{item.image}}" mode="aspectFill" />
        <view class="product-info">
          <text class="product-title">{{item.title}}</text>
          <view class="product-bottom">
            <text class="product-price">Â¥{{item.price}}</text>
            <van-tag type="primary" plain size="small">{{item.condition}}</van-tag>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½æç¤º -->
    <view class="loading-tip" wx:if="{{loading}}">
      <van-loading size="24px">åŠ è½½ä¸­...</van-loading>
    </view>
    <view class="no-more" wx:if="{{!hasMore && products.length > 0}}">
      <text>æ²¡æœ‰æ›´å¤šäº†~</text>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨å¯¼èˆª -->
  <van-tabbar active="{{activeTab}}" bind:change="onTabChange" active-color="#667eea">
    <van-tabbar-item icon="home-o">é¦–é¡µ</van-tabbar-item>
    <van-tabbar-item icon="plus">å‘å¸ƒ</van-tabbar-item>
    <van-tabbar-item icon="user-o">æˆ‘çš„</van-tabbar-item>
  </van-tabbar>
</view>