<!-- pages/index/index.wxml -->
<view class="container">
  <!-- 搜索头 -->
  <view class="header">
    <van-search
      value="{{ searchValue }}"
      placeholder="🔍 搜索神来闲置商品"
      background="transparent"
      shape="round"
      bind:search="onSearch"
    />
  </view>

  <!-- 分类导航 -->
  <scroll-view class="category-scroll" scroll-x>
    <view class="category-list">
      <view 
        class="category-item {{currentCategory === 'all' ? 'active' : ''}}"
        bind:tap="onCategoryTap"
        data-category="all"
      >
        <text class="category-icon">🏠</text>
        <text class="category-name">全部</text>
      </view>
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-item {{currentCategory === item.id ? 'active' : ''}}"
        bind:tap="onCategoryTap"
        data-category="{{item.id}}"
      >
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- 商品列表 -->
  <scroll-view 
    scroll-y 
    class="products-scroll"
    bindscrolltolower="onReachBottom"
    enable-back-to-top
  >
    <view class="products-grid">
      <view 
        wx:for="{{products}}" 
        wx:key="_id"
        class="product-card" 
        bind:tap="toDetail" 
        data-id="{{item._id}}"
      >
        <image class="product-image" src="{{item.image}}" mode="aspectFill" />
        <view class="product-info">
          <text class="product-title">{{item.title}}</text>
          <view class="product-bottom">
            <text class="product-price">¥{{item.price}}</text>
            <van-tag type="primary" plain size="small">{{item.condition}}</van-tag>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 加载提示 -->
    <view class="loading-tip" wx:if="{{loading}}">
      <van-loading size="24px">加载中...</van-loading>
    </view>
    <view class="no-more" wx:if="{{!hasMore && products.length > 0}}">
      <text>没有更多了~</text>
    </view>
  </scroll-view>

  <!-- 底部导航 -->
  <van-tabbar active="{{activeTab}}" bind:change="onTabChange" active-color="#667eea">
    <van-tabbar-item icon="home-o">首页</van-tabbar-item>
    <van-tabbar-item icon="plus">发布</van-tabbar-item>
    <van-tabbar-item icon="user-o">我的</van-tabbar-item>
  </van-tabbar>
</view>