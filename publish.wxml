<!-- pages/publish/publish.wxml -->
<view class="publish-container">
  <van-nav-bar title="发布商品" left-arrow bind:click-left="onBack" />
  
  <view class="form">
    <van-field
      label="标题"
      placeholder="请输入商品标题"
      value="{{form.title}}"
      bind:change="onFieldChange"
      data-field="title"
    />
    
    <van-field
      label="价格"
      placeholder="请输入商品价格"
      value="{{form.price}}"
      type="digit"
      bind:change="onFieldChange"
      data-field="price"
    />
    
    <van-field
      label="原价"
      placeholder="选填，原始购买价格"
      value="{{form.originalPrice}}"
      type="digit"
      bind:change="onFieldChange"
      data-field="originalPrice"
    />
    
    <!-- 分类选择 -->
    <van-cell
      title="商品分类"
      is-link
      value="{{categoryText}}"
      bind:click="showCategoryPicker"
    />
    
    <!-- 新旧程度选择 -->
    <van-cell
      title="新旧程度"
      is-link
      value="{{conditionText}}"
      bind:click="showConditionPicker"
    />
    
    <van-field
      label="描述"
      placeholder="请详细描述商品信息"
      value="{{form.desc}}"
      type="textarea"
      autosize
      bind:change="onFieldChange"
      data-field="desc"
    />
    
    <!-- 联系方式 -->
    <van-cell title="联系方式">
      <van-radio-group value="{{form.contactType}}" bind:change="onContactTypeChange">
        <van-radio name="wechat">微信</van-radio>
        <van-radio name="phone" custom-class="radio-margin">手机</van-radio>
      </van-radio-group>
    </van-cell>
    
    <van-field
      label="{{form.contactType === 'wechat' ? '微信号' : '手机号'}}"
      placeholder="{{form.contactType === 'wechat' ? '请输入微信号' : '请输入手机号'}}"
      value="{{form.contactValue}}"
      bind:change="onFieldChange"
      data-field="contactValue"
    />
    
    <!-- 图片上传 -->
    <view class="upload-section">
      <text class="upload-title">商品图片（最多9张）</text>
      <view class="image-list">
        <view class="image-item" wx:for="{{form.images}}" wx:key="index">
          <image src="{{item}}" mode="aspectFill" />
          <van-icon 
            name="close" 
            custom-class="delete-icon"
            bind:click="deleteImage"
            data-index="{{index}}"
          />
        </view>
        <view class="upload-btn" wx:if="{{form.images.length < 9}}" bind:tap="chooseImage">
          <van-icon name="plus" size="24px" color="#999" />
          <text class="upload-text">添加图片</text>
        </view>
      </view>
    </view>
  </view>
  
  <van-button type="primary" block custom-class="submit-btn" bind:click="submit">
    发布商品
  </van-button>
  
  <!-- 分类选择器 -->
  <van-popup show="{{showCategory}}" position="bottom">
    <van-picker
      columns="{{categoryColumns}}"
      show-toolbar
      title="选择分类"
      bind:confirm="onCategoryConfirm"
      bind:cancel="onCategoryCancel"
    />
  </van-popup>
  
  <!-- 新旧程度选择器 -->
  <van-popup show="{{showCondition}}" position="bottom">
    <van-picker
      columns="{{conditionColumns}}"
      show-toolbar
      title="选择新旧程度"
      bind:confirm="onConditionConfirm"
      bind:cancel="onConditionCancel"
    />
  </van-popup>
</view>